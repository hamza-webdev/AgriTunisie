(this["webpackJsonpagritunisie-frontend"]=this["webpackJsonpagritunisie-frontend"]||[]).push([[0],{16:function(e,t,a){},17:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),l=a(7),c=a.n(l),s=(a(16),a(2));const o=e=>{let{children:t,onClick:a,type:r="button",variant:l="primary",className:c="",disabled:s=!1,Icon:o}=e;return n.a.createElement("button",{type:r,onClick:a,disabled:s,className:"".concat("inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2"," ").concat({primary:"text-white bg-green-600 hover:bg-green-700 focus:ring-green-500",secondary:"text-green-700 bg-green-100 hover:bg-green-200 focus:ring-green-500",danger:"text-white bg-red-600 hover:bg-red-700 focus:ring-red-500",ghost:"text-gray-700 bg-transparent hover:bg-gray-100 focus:ring-gray-500"}[l]," ").concat(s?"opacity-50 cursor-not-allowed":""," ").concat(c)},o&&n.a.createElement(o,{className:"mr-2 h-5 w-5"}),t)};var m=a(18),i=a(19),u=a(20),d=a(21),g=a(22),p=a(23),E=a(24),x=a(25),b=a(26),v=a(27),f=a(28),h=a(29),y=a(30),N=a(31);const S=e=>{let{navigateTo:t}=e;const{user:a,logout:l,isAuthenticated:c}=Object(s.b)(),[S,w]=Object(r.useState)(!1),O=()=>{l(),t("login")},C=[{name:"Accueil",page:"home",icon:m.a,authRequired:!1},{name:"Mes Parcelles",page:"parcelles",icon:i.a,authRequired:!0},{name:"Catalogue Cultures",page:"cultures",icon:u.a,authRequired:!1},{name:"\xc9levage",page:"elevage",icon:d.a,authRequired:!0},{name:"Bourse des Prix",page:"prix",icon:g.a,authRequired:!1},{name:"M\xe9t\xe9o",page:"meteo",icon:p.a,authRequired:!0},{name:"Communaut\xe9",page:"communaute",icon:E.a,authRequired:!0},{name:"Conseils IA",page:"gemini",icon:x.a,authRequired:!0}];return n.a.createElement("nav",{className:"bg-white shadow-md sticky top-0 z-40"},n.a.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},n.a.createElement("div",{className:"flex items-center justify-between h-16"},n.a.createElement("div",{className:"flex items-center"},n.a.createElement(b.a,{className:"h-8 w-8 text-green-600"}),n.a.createElement("span",{className:"font-bold text-xl text-green-700 ml-2 cursor-pointer",onClick:()=>t("home")},"AgriTunisie")),n.a.createElement("div",{className:"hidden md:block"},n.a.createElement("div",{className:"ml-10 flex items-baseline space-x-4"},C.filter(e=>!e.authRequired||c).map(e=>n.a.createElement("button",{key:e.name,onClick:()=>t(e.page),className:"text-gray-600 hover:bg-green-50 hover:text-green-700 px-3 py-2 rounded-md text-sm font-medium flex items-center"},n.a.createElement(e.icon,{size:18,className:"mr-1"})," ",e.name)))),n.a.createElement("div",{className:"hidden md:block"},c&&a?n.a.createElement("div",{className:"ml-4 flex items-center md:ml-6"},n.a.createElement("span",{className:"text-gray-700 text-sm mr-3"},"Bonjour, ",a.nom_complet||a.email),n.a.createElement(o,{onClick:O,variant:"secondary",Icon:v.a},"D\xe9connexion")):n.a.createElement("div",{className:"space-x-2"},n.a.createElement(o,{onClick:()=>t("login"),variant:"primary",Icon:f.a},"Connexion"),n.a.createElement(o,{onClick:()=>t("register"),variant:"secondary",Icon:h.a},"Inscription"))),n.a.createElement("div",{className:"-mr-2 flex md:hidden"},n.a.createElement("button",{onClick:()=>w(!S),type:"button",className:"bg-green-50 inline-flex items-center justify-center p-2 rounded-md text-green-600 hover:text-green-700 hover:bg-green-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-green-500","aria-controls":"mobile-menu","aria-expanded":"false"},n.a.createElement("span",{className:"sr-only"},"Ouvrir le menu principal"),S?n.a.createElement(y.a,{className:"block h-6 w-6"}):n.a.createElement(N.a,{className:"block h-6 w-6"}))))),S&&n.a.createElement("div",{className:"md:hidden",id:"mobile-menu"},n.a.createElement("div",{className:"px-2 pt-2 pb-3 space-y-1 sm:px-3"},C.filter(e=>!e.authRequired||c).map(e=>n.a.createElement("button",{key:e.name,onClick:()=>{t(e.page),w(!1)},className:"text-gray-600 hover:bg-green-50 hover:text-green-700 block px-3 py-2 rounded-md text-base font-medium w-full text-left flex items-center"},n.a.createElement(e.icon,{size:18,className:"mr-2"})," ",e.name))),n.a.createElement("div",{className:"pt-4 pb-3 border-t border-gray-200"},c&&a?n.a.createElement("div",{className:"px-5"},n.a.createElement("div",{className:"text-base font-medium text-gray-800"},a.nom_complet||a.email),n.a.createElement("div",{className:"text-sm font-medium text-gray-500"},a.email),n.a.createElement(o,{onClick:()=>{O(),w(!1)},variant:"secondary",Icon:v.a,className:"mt-3 w-full"},"D\xe9connexion")):n.a.createElement("div",{className:"px-2 space-y-2"},n.a.createElement(o,{onClick:()=>{t("login"),w(!1)},variant:"primary",Icon:f.a,className:"w-full"},"Connexion"),n.a.createElement(o,{onClick:()=>{t("register"),w(!1)},variant:"secondary",Icon:h.a,className:"w-full"},"Inscription")))))};var w=()=>n.a.createElement("footer",{className:"bg-gray-100 border-t mt-auto"},n.a.createElement("div",{className:"max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8 text-center"},n.a.createElement("p",{className:"text-sm text-gray-500"},"\xa9 ",(new Date).getFullYear()," AgriTunisie Connect. Tous droits r\xe9serv\xe9s."),n.a.createElement("p",{className:"text-xs text-gray-400 mt-1"},"D\xe9velopp\xe9 avec passion pour l'agriculture tunisienne.")));var O=e=>{let{children:t,navigateTo:a}=e;return n.a.createElement("div",{className:"min-h-screen flex flex-col bg-gray-50"},n.a.createElement(S,{navigateTo:a}),n.a.createElement("main",{className:"flex-grow container mx-auto px-4 py-8 sm:px-6 lg:px-8"},t),n.a.createElement(w,null))};const C=e=>{let{children:t,className:a=""}=e;return n.a.createElement("div",{className:"bg-white shadow-lg rounded-lg p-6 ".concat(a)},t)};var T=()=>n.a.createElement(s.a,null,n.a.createElement(ee,null));const _=e=>{let{type:t="text",placeholder:a,value:r,onChange:l,name:c,label:s,required:o,error:m}=e;return n.a.createElement("div",{className:"mb-4"},s&&n.a.createElement("label",{htmlFor:c,className:"block text-sm font-medium text-gray-700 mb-1"},s,o&&n.a.createElement("span",{className:"text-red-500"},"*")),n.a.createElement("input",{type:t,id:c,name:c,placeholder:a,value:r,onChange:l,required:o,className:"mt-1 block w-full px-3 py-2 border ".concat(m?"border-red-500":"border-gray-300"," rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm")}),m&&n.a.createElement("p",{className:"mt-1 text-xs text-red-500"},m))};var j=a(32),k=a(33),P=a(34),I=a(35);const A=e=>{let{message:t,type:a="info",onClose:r}=e;const l={info:n.a.createElement(j.a,{size:20,className:"mr-2"}),success:n.a.createElement(k.a,{size:20,className:"mr-2"}),warning:n.a.createElement(P.a,{size:20,className:"mr-2"}),error:n.a.createElement(I.a,{size:20,className:"mr-2"})};return t?n.a.createElement("div",{className:"".concat("p-4 mb-4 rounded-md flex items-center justify-between"," ").concat({info:"bg-blue-100 text-blue-700",success:"bg-green-100 text-green-700",warning:"bg-yellow-100 text-yellow-700",error:"bg-red-100 text-red-700"}[a]),role:"alert"},n.a.createElement("div",{className:"flex items-center"},l[a],n.a.createElement("span",null,t)),r&&n.a.createElement("button",{onClick:r,className:"ml-4"},n.a.createElement(y.a,{size:20}))):null},D=e=>{let{size:t="md"}=e;return n.a.createElement("div",{className:"flex justify-center items-center"},n.a.createElement("div",{className:"".concat({sm:"h-6 w-6",md:"h-10 w-10",lg:"h-16 w-16"}[t]," animate-spin rounded-full border-4 border-green-500 border-t-transparent")}))};var R=e=>{let{navigateTo:t}=e;const[a,l]=Object(r.useState)(""),[c,m]=Object(r.useState)(""),[i,u]=Object(r.useState)(""),[d,g]=Object(r.useState)(!1),{login:p}=Object(s.b)();return n.a.createElement("div",{className:"max-w-md mx-auto mt-10"},n.a.createElement(C,null,n.a.createElement("div",{className:"text-center mb-6"},n.a.createElement(f.a,{size:48,className:"mx-auto text-green-600"}),n.a.createElement("h2",{className:"text-2xl font-bold text-gray-800 mt-2"},"Connexion")),i&&n.a.createElement(A,{message:i,type:"error",onClose:()=>u("")}),n.a.createElement("form",{onSubmit:async e=>{e.preventDefault(),u(""),g(!0);try{await p(a,c),t("dashboard")}catch(r){u(r.message||"Erreur de connexion. Veuillez v\xe9rifier vos identifiants.")}finally{g(!1)}}},n.a.createElement(_,{label:"Email",type:"email",name:"email",value:a,onChange:e=>l(e.target.value),required:!0}),n.a.createElement(_,{label:"Mot de passe",type:"password",name:"password",value:c,onChange:e=>m(e.target.value),required:!0}),n.a.createElement(o,{type:"submit",variant:"primary",className:"w-full",disabled:d,Icon:d?null:f.a},d?n.a.createElement(D,{size:"sm"}):"Se Connecter")),n.a.createElement("p",{className:"text-sm text-center mt-4"},"Pas encore de compte ? ",n.a.createElement("button",{onClick:()=>t("register"),className:"font-medium text-green-600 hover:text-green-500"},"Inscrivez-vous"))))};var z=e=>{let{navigateTo:t}=e;const[a,l]=Object(r.useState)(""),[c,m]=Object(r.useState)(""),[i,u]=Object(r.useState)(""),[d,g]=Object(r.useState)(""),[p,E]=Object(r.useState)(""),[x,b]=Object(r.useState)(""),[v,f]=Object(r.useState)(""),[y,N]=Object(r.useState)(!1),{register:S}=Object(s.b)();return n.a.createElement("div",{className:"max-w-md mx-auto mt-10"},n.a.createElement(C,null,n.a.createElement("div",{className:"text-center mb-6"},n.a.createElement(h.a,{size:48,className:"mx-auto text-green-600"}),n.a.createElement("h2",{className:"text-2xl font-bold text-gray-800 mt-2"},"Inscription")),x&&n.a.createElement(A,{message:x,type:"error",onClose:()=>b("")}),v&&n.a.createElement(A,{message:v,type:"success",onClose:()=>f("")}),n.a.createElement("form",{onSubmit:async e=>{if(e.preventDefault(),i===d){b(""),f(""),N(!0);try{await S({nom_complet:a,email:c,mot_de_passe:i,numero_telephone:p}),f("Inscription r\xe9ussie ! Vous pouvez maintenant vous connecter."),setTimeout(()=>t("login"),2e3)}catch(r){b(r.message||"Erreur lors de l'inscription.")}finally{N(!1)}}else b("Les mots de passe ne correspondent pas.")}},n.a.createElement(_,{label:"Nom complet",name:"nomComplet",value:a,onChange:e=>l(e.target.value),required:!0}),n.a.createElement(_,{label:"Email",type:"email",name:"email",value:c,onChange:e=>m(e.target.value),required:!0}),n.a.createElement(_,{label:"Num\xe9ro de t\xe9l\xe9phone (Optionnel)",name:"numeroTelephone",value:p,onChange:e=>E(e.target.value)}),n.a.createElement(_,{label:"Mot de passe",type:"password",name:"password",value:i,onChange:e=>u(e.target.value),required:!0}),n.a.createElement(_,{label:"Confirmer le mot de passe",type:"password",name:"confirmPassword",value:d,onChange:e=>g(e.target.value),required:!0}),n.a.createElement(o,{type:"submit",variant:"primary",className:"w-full",disabled:y,Icon:y?null:h.a},y?n.a.createElement(D,{size:"sm"}):"S'inscrire")),n.a.createElement("p",{className:"text-sm text-center mt-4"},"D\xe9j\xe0 un compte ? ",n.a.createElement("button",{onClick:()=>t("login"),className:"font-medium text-green-600 hover:text-green-500"},"Connectez-vous"))))};var L=e=>{let{navigateTo:t}=e;const{user:a}=Object(s.b)();return n.a.createElement(C,null,n.a.createElement("h1",{className:"text-2xl font-semibold text-gray-800 mb-4"},"Tableau de Bord"),n.a.createElement("p",{className:"text-gray-600"},"Bienvenue, ",(null===a||void 0===a?void 0:a.nom_complet)||(null===a||void 0===a?void 0:a.email)," !"),n.a.createElement("p",{className:"text-gray-600 mt-2"},"C'est ici que vous trouverez un aper\xe7u de votre exploitation."),n.a.createElement("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},n.a.createElement(o,{onClick:()=>t("parcelles"),Icon:i.a,className:"w-full justify-start p-6 text-left bg-green-50 hover:bg-green-100 text-green-700"},n.a.createElement("div",{className:"ml-2"},n.a.createElement("p",{className:"font-semibold"},"Mes Parcelles"),n.a.createElement("p",{className:"text-xs"},"G\xe9rer vos terrains agricoles"))),n.a.createElement(o,{onClick:()=>t("meteo"),Icon:p.a,className:"w-full justify-start p-6 text-left bg-blue-50 hover:bg-blue-100 text-blue-700"},n.a.createElement("div",{className:"ml-2"},n.a.createElement("p",{className:"font-semibold"},"M\xe9t\xe9o Agricole"),n.a.createElement("p",{className:"text-xs"},"Consulter les pr\xe9visions"))),n.a.createElement(o,{onClick:()=>t("prix"),Icon:g.a,className:"w-full justify-start p-6 text-left bg-yellow-50 hover:bg-yellow-100 text-yellow-700"},n.a.createElement("div",{className:"ml-2"},n.a.createElement("p",{className:"font-semibold"},"Bourse des Prix"),n.a.createElement("p",{className:"text-xs"},"Suivre les cours du march\xe9")))))},q=a(4);const U=async e=>q.a.get("/parcelles/".concat(e));var K=a(36),W=a(37),B=a(38),J=a(39);var M=e=>{let{navigateTo:t}=e;const[a,l]=Object(r.useState)([]),[c,m]=Object(r.useState)(!0),[i,u]=Object(r.useState)(""),[d,g]=Object(r.useState)(null),[p,E]=Object(r.useState)(1),{logout:x}=Object(s.b)(),b=Object(r.useCallback)(async e=>{m(!0),u("");try{const t=await async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return q.a.get("/parcelles/user?page=".concat(e,"&limit=").concat(t))}(e);l(t.data),g(t.pagination)}catch(a){u(a.message||"Erreur lors de la r\xe9cup\xe9ration des parcelles."),(a.message.includes("401")||a.message.includes("Acc\xe8s non autoris\xe9"))&&(x(),t("login"))}finally{m(!1)}},[x,t]);Object(r.useEffect)(()=>{b(p)},[b,p]);const v=async e=>{if(window.confirm("\xcates-vous s\xfbr de vouloir supprimer cette parcelle ?"))try{await(async e=>q.a.delete("/parcelles/".concat(e)))(e),l(a.filter(t=>t.id!==e)),1===a.length&&p>1?E(p-1):b(p)}catch(t){u(t.message||"Erreur suppression parcelle.")}},f=e=>{d&&e>=1&&e<=d.totalPages&&E(e)};return c?n.a.createElement("div",{className:"flex justify-center mt-10"},n.a.createElement(D,{size:"lg"})):n.a.createElement(C,null,n.a.createElement("div",{className:"flex justify-between items-center mb-6"},n.a.createElement("h1",{className:"text-2xl font-semibold text-gray-800"},"Mes Parcelles"),n.a.createElement(o,{onClick:()=>t("addParcelle"),variant:"primary",Icon:K.a},"Ajouter une Parcelle")),i&&n.a.createElement(A,{message:i,type:"error",onClose:()=>u("")}),0===a.length&&!c&&n.a.createElement("p",{className:"text-gray-600 text-center py-10"},"Vous n'avez pas encore de parcelles enregistr\xe9es."),a.length>0&&n.a.createElement("div",{className:"overflow-x-auto"},n.a.createElement("table",{className:"min-w-full divide-y divide-gray-200"},n.a.createElement("thead",{className:"bg-gray-50"},n.a.createElement("tr",null,n.a.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Nom"),n.a.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Superficie (ha)"),n.a.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type de Sol"),n.a.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions"))),n.a.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},a.map(e=>n.a.createElement("tr",{key:e.id},n.a.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},e.nom_parcelle),n.a.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},e.superficie_calculee_ha||"N/A"),n.a.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},e.type_sol_predominant||"N/A"),n.a.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2"},n.a.createElement(o,{onClick:()=>t("parcelleDetail/".concat(e.id)),variant:"ghost",Icon:W.a,className:"text-blue-600 hover:text-blue-800 p-1"},n.a.createElement("span",{className:"sr-only"},"Voir")),n.a.createElement(o,{onClick:()=>t("editParcelle/".concat(e.id)),variant:"ghost",Icon:B.a,className:"text-yellow-600 hover:text-yellow-800 p-1"},n.a.createElement("span",{className:"sr-only"},"Modifier")),n.a.createElement(o,{onClick:()=>v(e.id),variant:"ghost",Icon:J.a,className:"text-red-600 hover:text-red-800 p-1"},n.a.createElement("span",{className:"sr-only"},"Supprimer")))))))),d&&d.totalPages>1&&n.a.createElement("div",{className:"mt-6 flex justify-center items-center space-x-2"},n.a.createElement(o,{onClick:()=>f(p-1),disabled:1===p},"Pr\xe9c\xe9dent"),n.a.createElement("span",{className:"text-sm text-gray-700"},"Page ",p," sur ",d.totalPages),n.a.createElement(o,{onClick:()=>f(p+1),disabled:p===d.totalPages},"Suivant")))};var H=e=>{let{navigateTo:t,parcelleId:a}=e;const[l,c]=Object(r.useState)(""),[m,i]=Object(r.useState)(""),[u,d]=Object(r.useState)(""),[g,p]=Object(r.useState)(""),[E,x]=Object(r.useState)(""),[b,v]=Object(r.useState)(""),[f,h]=Object(r.useState)([]),[y,N]=Object(r.useState)(!1),[S,w]=Object(r.useState)(""),[O,T]=Object(r.useState)(""),{logout:j}=Object(s.b)(),k=!!a;Object(r.useEffect)(()=>{(async()=>{try{const e=await q.a.get("/cultures");h(e.data||e)}catch(e){console.error("Erreur chargement catalogue cultures:",e)}})(),k&&(N(!0),U(a).then(e=>{c(e.nom_parcelle),i(e.description||""),d(e.superficie_calculee_ha||""),p(e.type_sol_predominant||""),x(e.geometrie?JSON.stringify(e.geometrie):""),v(e.culture_actuelle_id||""),N(!1)}).catch(e=>{w(e.message||"Erreur chargement parcelle."),e.message.includes("401")&&(j(),t("login")),N(!1)}))},[a,k,j,t]);return y&&k&&!l?n.a.createElement("div",{className:"flex justify-center mt-10"},n.a.createElement(D,{size:"lg"})):n.a.createElement(C,null,n.a.createElement("h1",{className:"text-2xl font-semibold text-gray-800 mb-6"},k?"Modifier la Parcelle":"Ajouter une Nouvelle Parcelle"),S&&n.a.createElement(A,{message:S,type:"error",onClose:()=>w("")}),O&&n.a.createElement(A,{message:O,type:"success",onClose:()=>T("")}),n.a.createElement("form",{onSubmit:async e=>{let r;e.preventDefault(),w(""),T(""),N(!0);try{E&&(r=JSON.parse(E))}catch(s){return w("Format GeoJSON invalide."),void N(!1)}const n={nom_parcelle:l,description:m,superficie_calculee_ha:u?parseFloat(u):null,type_sol_predominant:g,geometrie:r,culture_actuelle_id:b?parseInt(b):null};try{k?(await(async(e,t)=>q.a.put("/parcelles/".concat(e),t))(a,n),T("Parcelle mise \xe0 jour !")):(await(async e=>q.a.post("/parcelles",e))(n),T("Parcelle cr\xe9\xe9e !"),c(""),i(""),d(""),p(""),x(""),v("")),setTimeout(()=>t("parcelles"),1500)}catch(s){w(s.message||"Erreur enregistrement parcelle."),s.message.includes("401")&&(j(),t("login"))}finally{N(!1)}},className:"space-y-6"},n.a.createElement(_,{label:"Nom de la parcelle",name:"nomParcelle",value:l,onChange:e=>c(e.target.value),required:!0,error:!l&&S?"Nom requis":""}),n.a.createElement("div",null,n.a.createElement("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1"},"Description"),n.a.createElement("textarea",{id:"description",name:"description",rows:"3",value:m,onChange:e=>i(e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm"})),n.a.createElement(_,{label:"Superficie (ha)",type:"number",name:"superficie",value:u,onChange:e=>d(e.target.value)}),n.a.createElement(_,{label:"Type de sol pr\xe9dominant",name:"typeSol",value:g,onChange:e=>p(e.target.value)}),n.a.createElement("div",null,n.a.createElement("label",{htmlFor:"geometrie",className:"block text-sm font-medium text-gray-700 mb-1"},"G\xe9om\xe9trie (GeoJSON)"),n.a.createElement("textarea",{id:"geometrie",name:"geometrie",rows:"5",value:E,onChange:e=>x(e.target.value),placeholder:'Ex: {"type":"Polygon","coordinates":[[[10.0,36.0],[10.1,36.0],[10.1,36.1],[10.0,36.1],[10.0,36.0]]]}',className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm font-mono text-xs"}),n.a.createElement("p",{className:"mt-1 text-xs text-gray-500"},"Collez ici la cha\xeene GeoJSON. Un outil cartographique sera int\xe9gr\xe9.")),n.a.createElement("div",null,n.a.createElement("label",{htmlFor:"cultureActuelleId",className:"block text-sm font-medium text-gray-700 mb-1"},"Culture Actuelle (Optionnel)"),n.a.createElement("select",{id:"cultureActuelleId",name:"cultureActuelleId",value:b,onChange:e=>v(e.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm rounded-md"},n.a.createElement("option",{value:""},"-- S\xe9lectionner --"),f.map(e=>n.a.createElement("option",{key:e.id,value:e.id},e.nom_culture)))),n.a.createElement("div",{className:"flex justify-end space-x-3"},n.a.createElement(o,{type:"button",variant:"secondary",onClick:()=>t("parcelles"),disabled:y},"Annuler"),n.a.createElement(o,{type:"submit",variant:"primary",disabled:y,Icon:y?null:k?B.a:K.a},y?n.a.createElement(D,{size:"sm"}):k?"Mettre \xe0 jour":"Cr\xe9er Parcelle"))))};var G=e=>{let{navigateTo:t,parcelleId:a}=e;const[l,c]=Object(r.useState)(null),[m,i]=Object(r.useState)(!0),[u,d]=Object(r.useState)(""),{logout:g}=Object(s.b)();return Object(r.useEffect)(()=>{a&&(i(!0),U(a).then(e=>{c(e),i(!1)}).catch(e=>{d(e.message||"Erreur chargement d\xe9tails parcelle."),e.message.includes("401")&&(g(),t("login")),i(!1)}))},[a,g,t]),m?n.a.createElement("div",{className:"flex justify-center mt-10"},n.a.createElement(D,{size:"lg"})):u?n.a.createElement(A,{message:u,type:"error"}):l?n.a.createElement(C,null,n.a.createElement("div",{className:"flex justify-between items-start"},n.a.createElement("h1",{className:"text-3xl font-bold text-gray-800 mb-2"},l.nom_parcelle),n.a.createElement(o,{onClick:()=>t("editParcelle/".concat(l.id)),variant:"secondary",Icon:B.a},"Modifier")),n.a.createElement("p",{className:"text-gray-600 mb-4"},l.description||"Aucune description."),n.a.createElement("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-6"},n.a.createElement("div",null,n.a.createElement("h3",{className:"text-lg font-semibold text-gray-700"},"Informations G\xe9n\xe9rales"),n.a.createElement("ul",{className:"mt-2 space-y-1 text-sm text-gray-600"},n.a.createElement("li",null,n.a.createElement("strong",null,"Superficie:")," ",l.superficie_calculee_ha||"N/A"," ha"),n.a.createElement("li",null,n.a.createElement("strong",null,"Type de sol:")," ",l.type_sol_predominant||"N/A"),n.a.createElement("li",null,n.a.createElement("strong",null,"Date de cr\xe9ation:")," ",new Date(l.date_creation).toLocaleDateString()))),n.a.createElement("div",null,n.a.createElement("h3",{className:"text-lg font-semibold text-gray-700"},"G\xe9om\xe9trie (GeoJSON)"),n.a.createElement("pre",{className:"mt-2 bg-gray-100 p-3 rounded-md text-xs overflow-x-auto"},JSON.stringify(l.geometrie,null,2)||"Non d\xe9finie"))),n.a.createElement("div",{className:"mt-8"},n.a.createElement(o,{onClick:()=>t("parcelles"),variant:"ghost"},"Retour \xe0 la liste"))):n.a.createElement(A,{message:"Parcelle non trouv\xe9e.",type:"warning"})};var V=e=>{let{navigateTo:t}=e;return n.a.createElement(C,null,n.a.createElement("h1",{className:"text-xl font-semibold"},"Catalogue des Cultures (\xc0 impl\xe9menter)"))};var F=e=>{let{navigateTo:t}=e;return n.a.createElement(C,null,n.a.createElement("h1",{className:"text-xl font-semibold"},"Gestion de l'\xc9levage (\xc0 impl\xe9menter)"))};var Y=e=>{let{navigateTo:t}=e;return n.a.createElement(C,null,n.a.createElement("h1",{className:"text-xl font-semibold"},"Bourse des Prix (\xc0 impl\xe9menter)"))};var Q=e=>{let{navigateTo:t}=e;return n.a.createElement(C,null,n.a.createElement("h1",{className:"text-xl font-semibold"},"M\xe9t\xe9o Agricole (\xc0 impl\xe9menter)"))};var X=e=>{let{navigateTo:t}=e;return n.a.createElement(C,null,n.a.createElement("h1",{className:"text-xl font-semibold"},"Communaut\xe9 & Forum (\xc0 impl\xe9menter)"))};var Z=e=>{let{navigateTo:t}=e;return n.a.createElement(C,null,n.a.createElement("h1",{className:"text-xl font-semibold"},"Conseils IA Gemini (\xc0 impl\xe9menter)"))};var $=()=>n.a.createElement(C,{className:"text-center"},n.a.createElement(P.a,{size:64,className:"mx-auto text-yellow-500 mb-4"}),n.a.createElement("h1",{className:"text-3xl font-bold text-gray-800"},"404 - Page Non Trouv\xe9e"),n.a.createElement("p",{className:"text-gray-600 mt-2"},"D\xe9sol\xe9, la page que vous recherchez n'existe pas."));var ee=function(){const[e,t]=Object(r.useState)("home"),[a,l]=Object(r.useState)(null),{isAuthenticated:c,loading:o}=Object(s.b)(),m=Object(r.useCallback)((function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t(e),l(a),window.scrollTo(0,0)}),[]);if(Object(r.useEffect)(()=>{if(!o)if(c)"login"!==e&&"register"!==e||m("dashboard");else{["dashboard","parcelles","addParcelle","editParcelle","parcelleDetail","elevage","meteo","communaute","gemini"].includes(e)&&m("login")}},[c,o,e,m]),o)return n.a.createElement("div",{className:"min-h-screen flex items-center justify-center bg-gray-50"},n.a.createElement(D,{size:"lg"}));let i;switch(e){case"home":i=n.a.createElement(T,{navigateTo:m});break;case"login":i=n.a.createElement(R,{navigateTo:m});break;case"register":i=n.a.createElement(z,{navigateTo:m});break;case"dashboard":i=c?n.a.createElement(L,{navigateTo:m}):n.a.createElement(R,{navigateTo:m});break;case"parcelles":i=c?n.a.createElement(M,{navigateTo:m}):n.a.createElement(R,{navigateTo:m});break;case"addParcelle":i=c?n.a.createElement(H,{navigateTo:m}):n.a.createElement(R,{navigateTo:m});break;case"editParcelle":i=c?n.a.createElement(H,{navigateTo:m,parcelleId:a}):n.a.createElement(R,{navigateTo:m});break;case"parcelleDetail":i=c?n.a.createElement(G,{navigateTo:m,parcelleId:a}):n.a.createElement(R,{navigateTo:m});break;case"cultures":i=n.a.createElement(V,{navigateTo:m});break;case"elevage":i=c?n.a.createElement(F,{navigateTo:m}):n.a.createElement(R,{navigateTo:m});break;case"prix":i=n.a.createElement(Y,{navigateTo:m});break;case"meteo":i=c?n.a.createElement(Q,{navigateTo:m}):n.a.createElement(R,{navigateTo:m});break;case"communaute":i=c?n.a.createElement(X,{navigateTo:m}):n.a.createElement(R,{navigateTo:m});break;case"gemini":i=c?n.a.createElement(Z,{navigateTo:m}):n.a.createElement(R,{navigateTo:m});break;default:i=n.a.createElement($,null)}return n.a.createElement(O,{navigateTo:m},i)};var te=()=>n.a.createElement(s.a,null,n.a.createElement(ee,null)," ");c.a.createRoot(document.getElementById("root")).render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(te,null)))},2:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return o}));var r=a(0),n=a.n(r);const l=(()=>{try{if("undefined"!==typeof e&&Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0})&&Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_API_URL)return Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_API_URL}catch(t){console.warn("AuthContext: Impossible d'acc\xe9der \xe0 process.env.REACT_APP_API_URL, utilisation de l'URL par d\xe9faut.",t)}return"http://localhost:3001/api"})(),c=Object(r.createContext)(null),s=e=>{let{children:t}=e;const[a,s]=Object(r.useState)(null),[o,m]=Object(r.useState)(localStorage.getItem("agritunisie_token")),[i,u]=Object(r.useState)(!0),d=Object(r.useCallback)(()=>{m(null),s(null),localStorage.removeItem("agritunisie_token"),localStorage.removeItem("agritunisie_user")},[]);Object(r.useEffect)(()=>{if(o)try{const e=localStorage.getItem("agritunisie_user");e?s(JSON.parse(e)):d()}catch(e){console.error("Erreur AuthContext: r\xe9cup\xe9ration utilisateur localStorage",e),d()}u(!1)},[o,d]);return n.a.createElement(c.Provider,{value:{user:a,token:o,login:async(e,t)=>{u(!0);try{const a=await fetch("".concat(l,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),r=await a.json();if(!a.ok)throw new Error(r.message||"\xc9chec de la connexion");return m(r.token),s(r.user),localStorage.setItem("agritunisie_token",r.token),localStorage.setItem("agritunisie_user",JSON.stringify(r.user)),u(!1),r}catch(a){throw console.error("Erreur de connexion (AuthContext):",a),u(!1),a}},register:async e=>{u(!0);try{const t=await fetch("".concat(l,"/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),a=await t.json();if(!t.ok)throw new Error(a.message||"\xc9chec de l'inscription");return u(!1),a}catch(t){throw console.error("Erreur d'inscription (AuthContext):",t),u(!1),t}},logout:d,loading:i,isAuthenticated:!!o}},t)},o=()=>Object(r.useContext)(c)}).call(this,a(5))},4:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return n}));const r=(()=>{try{if("undefined"!==typeof e&&Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0})&&Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_API_URL)return Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_API_URL}catch(t){console.warn("ApiService: Impossible d'acc\xe9der \xe0 process.env.REACT_APP_API_URL, utilisation de l'URL par d\xe9faut.",t)}return"http://localhost:3001/api"})(),n={get:async e=>{const t=localStorage.getItem("agritunisie_token"),a=await fetch("".concat(r).concat(e),{headers:{Authorization:"Bearer ".concat(t)}});if(!a.ok){401===a.status&&console.warn("API call 401 (apiService)");const e=await a.json().catch(()=>({message:a.statusText}));throw new Error(e.message||"Erreur API GET: ".concat(a.status))}return a.json()},post:async(e,t)=>{const a=localStorage.getItem("agritunisie_token"),n=await fetch("".concat(r).concat(e),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify(t)});if(!n.ok){const e=await n.json().catch(()=>({message:n.statusText}));throw new Error(e.message||"Erreur API POST: ".concat(n.status))}return n.json()},put:async(e,t)=>{const a=localStorage.getItem("agritunisie_token"),n=await fetch("".concat(r).concat(e),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify(t)});if(!n.ok){const e=await n.json().catch(()=>({message:n.statusText}));throw new Error(e.message||"Erreur API PUT: ".concat(n.status))}return n.json()},delete:async e=>{const t=localStorage.getItem("agritunisie_token"),a=await fetch("".concat(r).concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}});if(!a.ok){const e=await a.json().catch(()=>({message:a.statusText}));throw new Error(e.message||"Erreur API DELETE: ".concat(a.status))}return a.json()}}}).call(this,a(5))},8:function(e,t,a){e.exports=a(17)}},[[8,1,2]]]);
//# sourceMappingURL=main.4744db8f.chunk.js.map